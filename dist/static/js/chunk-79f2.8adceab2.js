(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-79f2"],{"79NY":function(e,t,a){"use strict";var r=a("8wGo");a.n(r).a},"8wGo":function(e,t,a){},"RU/L":function(e,t,a){a("Rqdy");var r=a("WEpk").Object;e.exports=function(e,t,a){return r.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var r=a("Y7ZC");r(r.S+r.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var r,n=a("SEkw"),s=(r=n)&&r.__esModule?r:{default:r};t.default=function(e,t,a){return t in e?(0,s.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},ZspD:function(e,t,a){e.exports=a.p+"static/img/multipleExport.dd06d70.png"},bZMq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(a("YEIV")),s=i(a("14Xm")),o=i(a("D3Ub")),l=i(a("QbLZ")),c=a("mvtb");function i(e){return e&&e.__esModule?e:{default:e}}t.default={name:"teacherManagement",data:function(){return{yearOptions:[],classOptions:[],genderOptions:[{value:"男",label:"男"},{value:"女",label:"女"}],isDisableOptions:[{value:"未禁用",label:"未禁用"},{value:"已禁用",label:"已禁用"}],typeOptions:[{value:"姓名",label:"姓名"},{value:"手机号",label:"手机号"}],editInfo:{old_username:"",password:"",user_gender:"",name:""},search_message:"",display:"none",search_select:"",editDisplay:"none",tableData:[],currentNumber:[],total:30,currentPage:1,ruleForm:{username:"",password:"",name:"",user_gender:""},searchParams:{search_select:"",search_message:"",page:1,limit:10},clickedRow:null,multipleSelection:{},selectedArr:[],cardDisplay:!1,headers:{Authorization:"Bearer "+this.getToken()},fileList:[]}},created:function(){this.getTeacherList(this.searchParams)},mounted:function(){},methods:(r={toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){e&&0!==e.length?(this.multipleSelection=e,console.log("mul,",this.multipleSelection),this.selectedArr=e.map(function(e){return(0,l.default)({},e,{user_manager_type:e.manager_type,manager_type:void 0})}),console.log(this.selectedArr,"selectedArr")):this.$message.info("没有选中的行")},handleSizeChange:function(e){this.pageSize=10,this.currentPage=1,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getTeacherList(this.searchParams)},handleInputChange:function(e){this.search_message=e},getTeacherList:function(e){var t=this;return(0,o.default)(s.default.mark(function a(){var r;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.page=t.currentPage,console.log("Requesting teachers with:",t.searchParams),a.next=5,(0,c.getTeacherList)(e);case 5:(r=a.sent)&&200===r.code&&r.data?(t.tableData=r.data.teacherInfo,t.total=r.data.allTeacherCount):(console.log("没有获取到数据或数据格式不正确"),t.$message.error("没有获取到数据或数据格式不正确")),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),console.error("获取老师列表失败:",a.t0),t.$message.error("获取老师列表失败，请稍后重试");case 13:case"end":return a.stop()}},a,t,[[0,9]])}))()},handleSearch:function(){var e=this;return(0,o.default)(s.default.mark(function t(){return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.search_message){t.next=3;break}return e.$message.warning("请输入搜索内容"),t.abrupt("return");case 3:return e.searchParams.search_select=e.search_select,e.searchParams.search_message=e.search_message,e.searchParams.page=1,console.log("searchParams:",e.searchParams),t.prev=7,t.next=10,e.getTeacherList(e.searchParams);case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(7),console.error("搜索失败:",t.t0),e.$message.error("搜索失败，请稍后重试");case 16:case"end":return t.stop()}},t,e,[[7,12]])}))()},resetSearch:function(){this.search_message="",this.search_select="",this.getTeacherList({page:1,limit:10})},disableButton:function(e){var t=this;if(console.log("scope:",e),!e||!e.row)return console.error("Scope or scope.row is undefined",e),void this.$message.error("尝试操作一个不存在的用户");var a=e.row.user_ban?"封禁":"解封";(0,c.banTeacher)(e.row.username).then(function(r){200===r.code?(t.$message.success(a+"老师账户成功"),e.row.user_ban=!e.row.user_ban,t.getTeacherList(t.searchParams)):t.$message.error(a+"老师账户失败")}).catch(function(e){console.error(a+"老师账户失败:",e),t.$message.error(a+"老师账户失败")})},addTeacher:function(){document.body.style="pointer-events: none;",document.getElementById("middle").style="pointer-events: auto;",this.ruleForm={username:"",password:"",name:"",user_gender:""},this.display="block"},close:function(){console.log("关闭"),this.display="none",document.body.style="pointer-events: auto;"},addSingleTeacher:function(){this.ruleForm.username&&this.ruleForm.password&&this.ruleForm.name?(console.log("Adding teacher with:",this.ruleForm),this.addSingleTeacherFun()):this.$message.warning("请填写完整信息")},addSingleTeacherFun:function(){var e=this;(0,c.addSingleTeacher)(this.ruleForm).then(function(t){200===t.code?(e.$message.success("添加老师成功"),e.ruleForm={username:"",password:"",name:"",user_gender:""},e.display="none",e.getTeacherList(e.searchParams)):e.$message.error(t.msg)}).catch(function(t){console.error("添加老师失败:",t),e.$message.error("添加老师失败")})},handleImportSuccess:function(e,t,a){200===e.code?(this.$message.success("批量导入成功"),this.getTeacherList(this.searchParams)):this.$message.error(e.msg||"批量导入失败")},handleImportError:function(e,t,a){this.$message.error("文件上传失败")},handleRowClick:function(e){this.clickedRow=e},editteacherInfo:function(e){if(!e||!e.row)return console.error("Scope or scope.row is undefined",e),void this.$message.error("未找到老师信息");var t=e.row.username;this.editInfo={name:e.row.name,user_gender:e.row.user_gender,username:t,old_username:t,password:e.row.password},this.editDisplay="block",this.getTeacherIdByUsername(t)},makeSureEdit:function(){var e=this,t=(0,l.default)({},this.editInfo,{old_username:this.editInfo.username,username:this.editInfo.old_username});(0,c.editTeacher)(t).then(function(t){200===t.code?(e.$message.success("编辑老师信息成功"),e.editDisplay="none",e.getTeacherList(e.searchParams)):e.$message.error(t.msg)}).catch(function(t){console.error("编辑老师信息失败:",t),e.$message.error("编辑老师信息失败")})},cancelEdit:function(){this.editDisplay="none"},setTeacherManagerFun:function(e,t){var a=this,r={username:e.username,manager_type:t};console.log("data:",r),(0,c.setTeacherManager)(r).then(function(r){200===r.code?(a.$set(e,"manager_type",t),a.$message.success("设为管理员成功"),a.getTeacherList(a.searchParams),console.log("guanliyuan:",a.tableData)):a.$message.error(r.msg)}).catch(function(e){console.error("设为管理员失败:",e),a.$message.error("设为管理员失败")})},handleSetManager:function(e){var t=this;if(this.multipleSelection.length){var a=e;console.log(a,"managertype"),this.multipleSelection.forEach(function(e){t.setTeacherManagerFun(e,a)})}else this.$message.warning("请选择至少一个老师")},deleteTeacher:function(e){var t=this;e&&e.username?(0,c.deleteTeacher)(e.username).then(function(e){200===e.code?(t.$message.success("删除老师成功"),t.getTeacherList(t.searchParams)):t.$message.error(e.msg)}).catch(function(e){console.error("删除老师失败:",e),t.$message.error("删除老师失败")}):this.$message.warning("未找到老师信息")},exportTeachers:function(){var e=this;return(0,o.default)(s.default.mark(function t(){var a,r,n;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.selectedArr.length){t.next=3;break}return e.$message.warning("请选择您要导出的老师"),t.abrupt("return");case 3:return t.prev=3,e.$message.info("正在导出..."),t.next=7,(0,c.outputMultipleTeacher)({selected_teachers:e.selectedArr});case 7:(a=t.sent)&&200===a.code?(r=window.URL.createObjectURL(new Blob([a.data],{type:"application/vnd.ms-excel"})),(n=document.createElement("a")).href=r,n.download="teachers-exported-data.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r),e.$message.success("批量导出成功")):e.$message.error("批量导出失败"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("批量导出失败:",t.t0),e.$message.error("批量导出失败");case 15:case"end":return t.stop()}},t,e,[[3,11]])}))()},exampleOpen:function(){this.cardDisplay=!0,document.getElementById("exampleId").style="pointer-events: auto;"},exampleClose:function(){this.cardDisplay=!1}},(0,n.default)(r,"exampleOpen",function(){this.cardDisplay=!0,document.getElementById("exampleId").style.pointerEvents="auto"}),(0,n.default)(r,"getToken",function(){return sessionStorage.getItem("token")}),(0,n.default)(r,"exampleClose",function(){this.cardDisplay=!1}),(0,n.default)(r,"handleGenderChange",function(e){this.ruleForm.user_gender=e,console.log("Selected gender:",e)}),r)}},cZuo:function(e,t,a){"use strict";a.r(t);var r=a("bZMq"),n=a.n(r);for(var s in r)"default"!==s&&function(e){a.d(t,e,function(){return r[e]})}(s);t.default=n.a},efh9:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap"},[r("div",{staticClass:"top"},[r("div",{staticClass:"second"},[r("div",{staticClass:"middle"},[r("el-select",{staticStyle:{width:"20%","margin-right":"10px"},attrs:{placeholder:"请选择"},model:{value:e.search_select,callback:function(t){e.search_select=t},expression:"search_select"}},[r("el-option",{attrs:{label:"账号",value:"username"}}),e._v(" "),r("el-option",{attrs:{label:"姓名",value:"name"}})],1),e._v(" "),r("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{input:e.handleInputChange},model:{value:e.search_message,callback:function(t){e.search_message=t},expression:"search_message"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search",type:"primary",size:"mini"},on:{click:e.handleSearch},slot:"append"},[e._v("搜索")])],1),e._v(" "),r("el-button",{attrs:{icon:"el-icon-refresh",type:"warning",size:"mini"},on:{click:e.resetSearch}},[e._v("重置")]),e._v(" "),r("el-button",{attrs:{type:"success",plain:"",id:"add",size:"mini"},on:{click:e.addTeacher}},[e._v("添加老师")])],1)]),e._v(" "),r("div",{style:{display:e.display},attrs:{id:"middle"}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("添加老师")]),e._v(" "),r("i",{staticClass:"el-icon-circle-close",on:{click:e.close}})]),e._v(" "),r("div",{staticClass:"text item"},[r("div",{staticClass:"text-left"},[r("p",[e._v("单个添加")]),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"name","label-width":"50px"}},[r("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别",prop:"user_gender","label-width":"50px"}},[r("el-input",{model:{value:e.ruleForm.user_gender,callback:function(t){e.$set(e.ruleForm,"user_gender",t)},expression:"ruleForm.user_gender"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"账号",prop:"username","label-width":"50px"}},[r("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password","label-width":"50px"}},[r("el-input",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),e._v(" "),r("div",{staticClass:"signal-button"},[r("el-button",{staticStyle:{padding:"3px 0"},attrs:{type:"text"},on:{click:e.addSingleTeacher}},[e._v("单个添加")])],1)],1),e._v(" "),r("div",{staticClass:"text-right"},[r("p",[e._v("批量导入")]),e._v(" "),r("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://192.168.10.7:8881/teacherManage/addMultipleTeacher","on-success":e.handleImportSuccess,headers:e.headers,multiple:"","on-error":e.handleImportError,accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}},[r("i",{staticClass:"el-icon-upload"}),e._v(" "),r("div",{staticClass:"el-upload__text"},[e._v("将Excel表格文件拖到此处，或"),r("em",[e._v("点击上传")])]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n                注：只能上传excel表格(其中包含个人的班级、姓名、学号、密码)\n                "),r("p",[e._v("\n                  示例\n                  "),r("a",{staticStyle:{"text-decoration":"underline",color:"#409eff"},on:{click:e.exampleOpen}},[e._v("请看这里")])])])])],1),e._v(" "),r("el-dialog",{attrs:{title:"按照下面的格式进行上传文件：",visible:e.cardDisplay,width:"30%","modal-append-to-body":!1,"append-to-body":!0,"show-close":!1,id:"exampleId"},on:{"update:visible":function(t){e.cardDisplay=t}}},[r("img",{staticStyle:{width:"400px",height:"400px"},attrs:{src:a("ZspD")}}),e._v(" "),r("el-button",{on:{click:e.exampleClose}},[e._v("我知道了")])],1)],1)])],1)]),e._v(" "),r("div",{ref:"edit",staticClass:"edit",style:{display:e.editDisplay}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("信息更改")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0","margin-right":"20px"},attrs:{type:"text"},on:{click:e.makeSureEdit}},[e._v("确定")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0","margin-right":"20px"},attrs:{type:"text"},on:{click:e.cancelEdit}},[e._v("取消")])],1),e._v(" "),r("el-form",{attrs:{"label-width":"80px",model:e.editInfo}},[r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{model:{value:e.editInfo.name,callback:function(t){e.$set(e.editInfo,"name",t)},expression:"editInfo.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别"}},[r("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.editInfo.user_gender,callback:function(t){e.$set(e.editInfo,"user_gender",t)},expression:"editInfo.user_gender"}},[r("el-option",{attrs:{label:"男",value:"男"}}),e._v(" "),r("el-option",{attrs:{label:"女",value:"女"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"电话号"}},[r("el-input",{model:{value:e.editInfo.old_username,callback:function(t){e.$set(e.editInfo,"old_username",t)},expression:"editInfo.old_username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码"}},[r("el-input",{attrs:{type:"password"},model:{value:e.editInfo.password,callback:function(t){e.$set(e.editInfo,"password",t)},expression:"editInfo.password"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"bottom"},[r("div",{staticClass:"table-top"},[r("p",[e._v("老师列表")]),e._v(" "),r("div",{staticClass:"top-right"},[r("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleSetManager}},[r("span",{staticClass:"el-dropdown-link"},[e._v(" 设为管理员 ")]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:"大一管理员"}},[e._v("大一管理员")]),e._v(" "),r("el-dropdown-item",{attrs:{command:"大二管理员"}},[e._v("大二管理员")]),e._v(" "),r("el-dropdown-item",{attrs:{command:"大三管理员"}},[e._v("大三管理员")]),e._v(" "),r("el-dropdown-item",{attrs:{command:"大四管理员"}},[e._v("大四管理员")])],1)],1),e._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"注意：",width:"200",trigger:"hover",content:"设置管理员时，先在表格中选择人员"}},[r("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1)]),e._v(" "),r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark","header-align":"center"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"手机号","show-overflow-tooltip":"",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"password",label:"密码","show-overflow-tooltip":"",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"user_gender",label:"性别",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"manager_type",label:"管理员类型","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["年级管理员"===t.row.manager_type?r("span",[e._v("大一管理员")]):"大二管理员"===t.row.manager_type?r("span",[e._v("大二管理员")]):"大三管理员"===t.row.manager_type?r("span",[e._v("大三管理员")]):"大四管理员"===t.row.manager_type?r("span",[e._v("大四管理员")]):"院级管理员"===t.row.manager_type?r("span",[e._v("院级管理员")]):r("span",[e._v("无")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"user_ban",label:"账户禁用","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.disableButton(t)}},model:{value:t.row.user_ban,callback:function(a){e.$set(t.row,"user_ban",a)},expression:"scope.row.user_ban"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"function",label:"操作","show-overflow-tooltip":"",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{staticStyle:{"margin-right":"20px",color:"#75d6a9"},on:{click:function(a){return e.editteacherInfo(t)}}},[e._v("编辑信息")]),e._v(" "),r("a",{staticStyle:{"margin-right":"20px",color:"red"},on:{click:function(a){return e.deleteTeacher(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{staticClass:"paginatio"},[r("span",{on:{click:e.exportTeachers}},[e._v("批量导出")]),e._v(" "),r("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])},n=[];a.d(t,"a",function(){return r}),a.d(t,"b",function(){return n})},mvtb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteMultipleTeacher=void 0;var r=s(a("gDS+"));t.getTeacherList=function(e){return(0,n.default)({url:"/teacherManage/queryTeacher",method:"post",data:e})},t.addSingleTeacher=function(e){return(0,n.default)({url:"/teacherManage/addSingleTeacher",method:"post",data:e})},t.addMultipleTeacher=function(e){return(0,n.default)({url:"/teacherManage/addMultipleTeacher",method:"post",data:e})},t.deleteTeacher=function(e){var t={username:e};return(0,n.default)({url:"/teacherManage/deleteTeacher",method:"post",data:t})},t.banTeacher=function(e){var t={username:e};return(0,n.default)({url:"/teacherManage/banTeacher",method:"post",data:t})},t.getUsername=function(e){return(0,n.default)({url:"/teacherManage/getUsername",method:"post",data:e})},t.editTeacher=function(e){return(0,n.default)({url:"/teacherManage/editTeacher",method:"post",data:e})},t.setTeacherManager=function(e){return(0,n.default)({url:"/teacherManage/setTeacherManager",method:"post",data:e})},t.outputMultipleTeacher=function(e){return(0,n.default)({url:"/teacherManage/outputMultipleTeacher",method:"post",data:e})};var n=s(a("t3Un"));function s(e){return e&&e.__esModule?e:{default:e}}t.deleteMultipleTeacher=function(e){return n.default.post("/teacherManage/deleteMultipleTeacher",(0,r.default)(e))}},v27Z:function(e,t,a){"use strict";a.r(t);var r=a("efh9"),n=a("cZuo");for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);a("79NY");var o=a("KHd+"),l=Object(o.a)(n.default,r.a,r.b,!1,null,"67d27ff6",null);l.options.__file="index.vue",t.default=l.exports}}]);