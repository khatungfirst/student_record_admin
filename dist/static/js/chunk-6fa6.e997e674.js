(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6fa6"],{J3Nr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=l(a("14Xm")),r=l(a("D3Ub")),n=a("XJYT"),i=(a("L2JU"),a("deRP"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"star",data:function(){return{search:"",tableData:[],table:[],mul:[],term:null,classData:[],gradeData:[],hospitalData:[],isSelected:!1,remainder:3,maxSelectedCount:3,isAll:!1,isDisabled:!1,limit:5,page:1,total:0,buttonDisabled:!1,publicButton:!0,headline:0,publicedList:[],cardDis:!1}},created:function(){var t=this;return(0,r.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("starPage",t.page),t.initStar(),t.searchTerm();case 3:case"end":return e.stop()}},e,t)}))()},methods:{initStar:function(){var t=this;return(0,r.default)(s.default.mark(function e(){var a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.page=t.publicButton?JSON.parse(localStorage.getItem("starPage")):1,e.next=3,(0,i.initStar)(t.limit,t.page,t.search);case 3:null!==(a=e.sent).data&&(t.tableData=a.data.tableData,t.table=null===t.tableData?[]:t.tableData,t.total=a.data.total,t.maxSelectedCount=a.data.peopleLimit,t.buttonDisabled=a.data.isDisabled,t.search="",t.headline=a.data.headline,t.table.map(function(e,a){t.mul.find(function(t){return t.username===e.username})&&(e.status=!0)}));case 5:case"end":return e.stop()}},e,t)}))()},initPublic:function(t){var e=this;return(0,r.default)(s.default.mark(function a(){return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:null!==t&&(e.classData=t.data.classData,e.gradeData=t.data.gradeData,e.hospitalData=t.data.hospitalData);case 1:case"end":return a.stop()}},a,e)}))()},searchTerm:function(){var t=this;return(0,r.default)(s.default.mark(function e(){var a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.term,"term"),null===t.term&&(t.term=0),e.next=4,(0,i.termStar)(t.term);case 4:a=e.sent,t.initPublic(a);case 6:case"end":return e.stop()}},e,t)}))()},allCheck:function(){var t=this;this.isAll=!this.isAll,this.table.length>this.maxSelectedCount?((0,n.Message)({message:"选择数目超过名额，无法选择！"}),this.isAdd=!1,this.isAll=!1,console.log(this.isAdd,"add1")):this.table.forEach(function(e){e.status=t.isAll,t.handleSelectionChange(e,!0)})},handleCurrentChange:function(t){localStorage.setItem("starPage",t),this.initStar()},handleSelectionChange:function(t,e){var a=this;return(0,r.default)(s.default.mark(function r(){return s.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t.status=e,a.mul.find(function(e){return e.username===t.username})?a.mul=a.mul.filter(function(e){return e.username!==t.username}):(a.multipleSelection=t,a.mul.length<a.maxSelectedCount?(a.mul.push(a.multipleSelection),a.remainder=a.maxSelectedCount-a.mul.length,a.mul.length===a.tableData.length&&(a.isAll=!0),0===a.remainder&&((0,n.Message)({message:"名额已经选满喽~~~"}),a.isDisabled=!0)):(0,n.Message)({message:"名额已经选满喽，推选无效~"}));case 3:case"end":return s.stop()}},r,a)}))()},electUsers:function(){var t=this;return(0,r.default)(s.default.mark(function e(){var a,r,l;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.mul.length){e.next=4;break}(0,n.Message)({message:"您还没有选择推选的人员"}),e.next=17;break;case 4:return a=JSON.parse(localStorage.getItem("userInfo")),"grade1"!==(r=a.role)&&"grade2"!==r&&"grade3"!==r&&"grade4"!==r||(r="grade"),e.next=9,(0,i.elected)(t.mul,r);case 9:if("数据已存在"===(l=e.sent).msg){e.next=17;break}if("No seats left"!==l.data.news){e.next=17;break}return console.log("禁用按钮"),e.next=15,(0,i.optional)();case 15:t.buttonDisabled=!0,(0,n.Message)({message:"推选名额已经用完喽"});case 17:t.mul=[],t.isAll=!1,t.publicButton=!1,t.initStar();case 21:case"end":return e.stop()}},e,t)}))()},publicStar:function(){var t=this;return(0,r.default)(s.default.mark(function e(){var a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.buttonDisabled=!1,e.next=3,(0,i.publicStar)();case 3:a=e.sent,t.initPublic(a),t.initStar();case 6:case"end":return e.stop()}},e,t)}))()},newSelect:function(){this.table=this.tableData,this.isDisabled=!1,this.isAll=!1,this.table.forEach(function(t){t.status=!1}),this.mul=[]},know:function(){this.cardDis=!1},watchStar:function(){var t=this;return(0,r.default)(s.default.mark(function e(){var a,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.cardDis=!t.cardDis,e.next=3,(0,i.electedStar)();case 3:a=e.sent,r=a.data,t.publicedList=r.list;case 6:case"end":return e.stop()}},e,t)}))()}}}},deRP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.electedStar=e.optional=e.termStar=e.publicStar=e.elected=e.initStar=void 0;var s,r=a("t3Un"),n=(s=r)&&s.__esModule?s:{default:s};e.initStar=function(t,e,a){return n.default.get("/star/select",{params:{pageCapacity:t,page:e,search:a}})},e.elected=function(t,e){return n.default.post("/star/elected/"+e,{electedArr:t})},e.publicStar=function(){return n.default.post("/star/public/college")},e.termStar=function(t){return n.default.get("/star/termStar",{params:{termNumber:t}})},e.optional=function(){return n.default.post("/star/change_disabled")},e.electedStar=function(){return n.default.get("/star/is_elected")}},"lW9+":function(t,e,a){"use strict";a.r(e);var s=a("pbwU"),r=a("mCx6");for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);a("tJZK");var i=a("KHd+"),l=Object(i.a)(r.default,s.a,s.b,!1,null,"3cac7bae",null);l.options.__file="index.vue",e.default=l.exports},mCx6:function(t,e,a){"use strict";a.r(e);var s=a("J3Nr"),r=a.n(s);for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);e.default=r.a},pbwU:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"top"},[a("el-input",{attrs:{placeholder:"请搜索要推选的人的姓名"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"star:user:query",expression:"'star:user:query'"}],attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.initStar}},[t._v("搜索")])],1),t._v(" "),t.cardDis?a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("已推选人员：")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.know}},[t._v("我知道了")])],1),t._v(" "),t._l(t.publicedList,function(e){return a("div",{key:e,staticClass:"text item"},[a("span",[t._v(" "+t._s(e))])])})],2):t._e(),t._v(" "),a("div",{staticClass:"middle"},[a("table",[a("thead",[a("tr",[a("th",{attrs:{width:"1"}},[a("el-checkbox",{attrs:{value:t.isAll},on:{change:t.allCheck}})],1),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("学号")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("姓名")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("贴子数")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("粉丝数")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("积分")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("热度")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("文章质量")]),t._v(" "),a("th",{attrs:{width:"140"}},[t._v("被推选次数")])])]),t._v(" "),a("tbody",[0===t.table.length?a("tr",[a("td",{staticClass:"empty",staticStyle:{"text-align":"center"},attrs:{colspan:"9"}},[t._v("\n            暂时没有数据\n          ")])]):t._l(t.table,function(e){return a("tr",{key:e.username},[a("td",[a("el-checkbox",{attrs:{value:e.status,disabled:t.isDisabled},on:{change:function(a){return t.handleSelectionChange(e,a)}}})],1),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.username))])]),t._v(" "),a("td",[a("div",{staticClass:"tc"},[a("div",[a("p",{staticClass:"name ellipsis"},[t._v("\n                  "+t._s(e.name)+"\n                ")])])])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.user_article_total))])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.userfans))])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.score))])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.hot))])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.quality))])]),t._v(" "),a("td",{staticClass:"tc"},[a("p",[t._v(t._s(e.frequency))])])])})],2)]),t._v(" "),a("div",{staticClass:"middle-bottom"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.page,"page-size":5,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1),t._v(" "),a("div",{staticClass:"middle-button"},[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v("重新选择只在推选前有效")]),t._v(" "),a("i",{staticClass:"el-icon-question"})]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:t.buttonDisabled},on:{click:t.newSelect}},[t._v("重新选择"),a("i",{staticClass:"el-icon-refresh-right"})]),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"star:user:select",expression:"'star:user:select'"}],attrs:{type:"primary",disabled:t.buttonDisabled},on:{click:t.electUsers}},[t._v("推选第"+t._s(t.headline)+"届成长之星"),a("i",{staticClass:"el-icon-s-promotion"})]),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"star:user:public",expression:"'star:user:public'"}],attrs:{type:"primary",disabled:t.publicButton},on:{click:t.publicStar}},[t._v("发布")]),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"star:elected:list",expression:"'star:elected:list'"}],attrs:{type:"primary"},on:{click:t.watchStar}},[t._v("查看本届已推选人员")])],1)])]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"bottom-top"},[a("p",[t._v("成长之星公示")]),t._v(" "),a("el-input",{directives:[{name:"permission",rawName:"v-permission",value:"star:term:query",expression:"'star:term:query'"}],attrs:{placeholder:"请用阿拉伯数字"},on:{change:t.searchTerm},model:{value:t.term,callback:function(e){t.term=e},expression:"term"}},[a("template",{slot:"prepend"},[t._v("查找第")]),t._v(" "),a("template",{slot:"append"},[t._v("届成长之星名单")])],2)],1),t._v(" "),a("div",{staticClass:"publicity"},[a("div",{staticClass:"classPublicity"},[t._m(0),t._v(" "),t._l(t.classData,function(e,s){return a("div",{key:s,staticClass:"list"},[a("p",{staticClass:"className"},[t._v(t._s(e.className)+":")]),t._v(" "),t._l(t.classData[s].classStar,function(e,s){return a("span",{key:s},[t._v(t._s(e))])})],2)})],2),t._v(" "),a("div",{staticClass:"gradePublicity"},[t._m(1),t._v(" "),t._l(t.gradeData,function(e,s){return a("div",{key:s,staticClass:"list1"},[a("span",[t._v(t._s(e.gradeName)+"-"+t._s(e.gradeClass))])])})],2),t._v(" "),a("div",{staticClass:"hospitalPublicity"},[t._m(2),t._v(" "),t._l(t.hospitalData,function(e,s){return a("div",{key:s,staticClass:"list1"},[a("span",[t._v(t._s(e.gradeName)+"-"+t._s(e.gradeClass))])])})],2)])])],1)},r=[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[e("i",{staticClass:"el-icon-star-on"}),this._v("班级之星")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[e("i",{staticClass:"el-icon-star-on"}),e("i",{staticClass:"el-icon-star-on"}),this._v("年级之星\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[e("i",{staticClass:"el-icon-star-on"}),e("i",{staticClass:"el-icon-star-on"}),e("i",{staticClass:"el-icon-star-on"}),this._v("院级之星\n        ")])}];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return r})},"q0v/":function(t,e,a){},tJZK:function(t,e,a){"use strict";var s=a("q0v/");a.n(s).a}}]);