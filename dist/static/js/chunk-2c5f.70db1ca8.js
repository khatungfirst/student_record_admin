(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2c5f"],{BKju:function(e,t,n){},fXZc:function(e,t,n){"use strict";n.r(t);var r=n("tHha"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);t.default=i.a},i58J:function(e,t,n){"use strict";var r=n("BKju");n.n(r).a},jxCC:function(e,t,n){"use strict";n.r(t);var r=n("w+d5"),i=n("fXZc");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("i58J");var a=n("KHd+"),l=Object(a.a)(i.default,r.a,r.b,!1,null,"0a53d5ed",null);l.options.__file="index.vue",t.default=l.exports},tHha:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n("P2sY")),i=s(n("QbLZ")),o=s(n("14Xm")),a=s(n("D3Ub")),l=n("zF5t");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"rolemanagement",directives:{ClickOutside:{bind:function(e,t,n){var r=function(r){e.contains(r.target)||n.context[t.expression]()};e.clickOutsideEvent=r,document.addEventListener("click",r)},unbind:function(e){document.removeEventListener("click",e.clickOutsideEvent)}}},data:function(){return{list:[],showDialog:!1,pageParams:{page:1,pageSize:6,total:50},roleForm:{role_name:"",role_Engname:"",selectedPermission:""},rules:{role_name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],role_Engname:[{required:!0,message:"角色编码不能为空",trigger:"blur"}],selectedPermission:[{required:!0,message:"权限分配不能为空",trigger:"blur"}]},showPermissionDialog:!1,selectedPermission:""}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;return(0,a.default)(o.default.mark(function t(){var n;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,l.getRoleList)(e.pageParams);case 3:if(n=t.sent,console.log(n),200!==n.code||!Array.isArray(n.data)){t.next=10;break}e.list=n.data,e.list.forEach(function(t){e.$set(t,"isEdit",!1),e.$set(t,"editRow",{role_name:t.role_name,role_Engname:t.role_Engname})}),t.next=11;break;case 10:throw new Error("Invalid data format");case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.error("Error fetching role list:",t.t0),e.$message.error("Failed to fetch role list");case 17:case"end":return t.stop()}},t,e,[[0,13]])}))()},changePage:function(e){this.pageParams.page=e,this.getRoleList()},focusInput:function(){this.showOptions=!0},blurInput:function(){this.showOptions=!1},handleSelect:function(e){this.selectedPermission=e,this.$message.success("已选择数据权限: "+e),this.showOptions=!1},hideOptions:function(){this.showOptions=!1},btnOK:function(){var e,t=this;this.refs.roleForm.validate((e=(0,a.default)(o.default.mark(function e(n){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,(0,l.addRole)(t.roleForm);case 3:t.$message.success("新增角色成功"),t.getRoleList(),t.btnCancel();case 6:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},btnCancel:function(){this.$refs.roleForm.resetFields(),this.showDialog=!1},btnEditRow:function(e){e.isEdit=!0,e.editRow.role_name=e.role_name,e.editRow.role_Engname=e.role_Engname},btnEditOK:function(e){var t=this;return(0,a.default)(o.default.mark(function n(){return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.editRow.role_Engname||!e.editRow.role_name){n.next=7;break}return n.next=3,(0,l.updateRole)((0,i.default)({},e.editRow,{id:e.role_id}));case 3:t.$message.success("更新角色成功"),(0,r.default)(e,(0,i.default)({},editRow,{isEdit:!1})),n.next=8;break;case 7:t.$message.warning("角色和编码不能为空");case 8:case"end":return n.stop()}},n,t)}))()},confirmDel:function(e){var t=this;return(0,a.default)(o.default.mark(function n(){return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,l.delRole)(e);case 2:t.$message.success("删除角色成功"),1===t.list.length&&t.pageParams.page--,t.getRoleList();case 5:case"end":return n.stop()}},n,t)}))()},btnPermission:function(){this.showPermissionDialog=!0}}}},"w+d5":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"app-container"},[n("div",{staticClass:"role-operate"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.showDialog=!0}}},[e._v("添加角色")])],1),e._v(" "),n("el-table",{attrs:{data:e.list}},[n("el-table-column",{attrs:{label:"角色名称",align:"center",width:"200",prop:"role_name"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.isEdit?n("el-input",{attrs:{size:"mini"},model:{value:r.editRow.role_name,callback:function(t){e.$set(r.editRow,"role_name",t)},expression:"row.editRow.role_name"}}):n("span",[e._v(e._s(r.role_name))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"角色编码",align:"center",width:"200",prop:"role_Engname"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.isEdit?n("el-input",{attrs:{size:"mini"},model:{value:r.editRow.role_Engname,callback:function(t){e.$set(r.editRow,"role_Engname",t)},expression:"row.editRow.role_Engname"}}):n("span",[e._v(" "+e._s(r.role_Engname)+" ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.isEdit?[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.btnEditOK(r)}}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){r.isEdit=!1}}},[e._v("取消")])]:[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.btnPermission}},[e._v("分配权限")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.btnEditRow(r)}}},[e._v("编辑")]),e._v(" "),n("el-popconfirm",{attrs:{title:"你确定要删除吗?"},on:{confirm:function(t){return e.confirmDel(r.role_id)}}},[n("el-button",{attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("删除")])],1)]]}}])})],1),e._v(" "),n("el-row",{staticStyle:{height:"60px"},attrs:{type:"flex",align:"middle",justify:"start"}},[n("el-pagination",{attrs:{"page-size":e.pageParams.pageSize,"current-page":e.pageParams.page,total:e.pageParams.total,layout:"prev, pager, next"},on:{"current-change":e.changePage}})],1)],1),e._v(" "),n("el-dialog",{attrs:{width:"500px",title:"新增角色",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-form",{ref:"roleFormRef",attrs:{"label-width":"120px",model:e.roleForm,rules:e.rules}},[n("el-form-item",{attrs:{prop:"role_name",label:"角色名称"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"mini"},model:{value:e.roleForm.role_name,callback:function(t){e.$set(e.roleForm,"role_name",t)},expression:"roleForm.role_name"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"role_Engname",label:"角色编码"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"mini"},model:{value:e.roleForm.role_Engname,callback:function(t){e.$set(e.roleForm,"role_Engname",t)},expression:"roleForm.role_Engname"}})],1),e._v(" "),[n("el-form-item",{staticClass:"data-permission-form-item",attrs:{prop:"selectedPermission",label:"数据权限"}},[n("el-input",{ref:"inputRef",attrs:{size:"mini",placeholder:"请选择数据权限"},on:{focus:function(t){e.showOptions=!0}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSelect(t)}},scopedSlots:e._u([{key:"append",fn:function(){return[n("el-icon",{staticClass:"el-icon-arrow-down el-icon--right",class:{rotate:e.showOptions}})]},proxy:!0}]),model:{value:e.selectedPermission,callback:function(t){e.selectedPermission=t},expression:"selectedPermission"}}),e._v(" "),n("el-select",{staticStyle:{width:"300px",display:"none"},attrs:{placeholder:"请选择数据权限"},on:{change:e.handleSelect,blur:e.hideOptions},model:{value:e.roleForm.selectedPermission,callback:function(t){e.$set(e.roleForm,"selectedPermission",t)},expression:"roleForm.selectedPermission"}},[n("el-option",{attrs:{label:"全部数据",value:"all"}}),e._v(" "),n("el-option",{attrs:{label:"大一用户数据",value:"year1"}}),e._v(" "),n("el-option",{attrs:{label:"大二用户数据",value:"year2"}}),e._v(" "),n("el-option",{attrs:{label:"大三用户数据",value:"year3"}}),e._v(" "),n("el-option",{attrs:{label:"大四用户数据",value:"year4"}}),e._v(" "),n("el-option",{attrs:{label:"本班用户数据",value:"class"}})],1)],1),e._v(" "),n("el-form-item",[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:"12"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.btnOK}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.btnCancel}},[e._v("取消")])],1)],1)],1)]],2)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.showPermissionDialog,title:"分配权限"},on:{"update:visible":function(t){e.showPermissionDialog=t}}},[n("el-tree")],1)],1)},i=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},zF5t:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRoleList=function(e){return(0,o.default)({url:"/role/list",method:"get",data:e})},t.addRole=function(e){return(0,o.default)({url:"/role/addRole",method:"post",data:e})},t.updateRole=function(e){return(0,o.default)({url:"/role/modify/"+e.role_id,method:"put",data:e})},t.delRole=function(e){return(0,o.default)({url:"/role/delete/"+e,method:"delete"})};var r,i=n("t3Un"),o=(r=i)&&r.__esModule?r:{default:r}}}]);