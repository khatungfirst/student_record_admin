(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3c4c"],{"/f1G":function(t,e,a){t.exports={default:a("nhzr"),__esModule:!0}},CEpE:function(t,e,a){"use strict";var r=a("djtY");a.n(r).a},E8gZ:function(t,e,a){var r=a("jmDH"),n=a("w6GO"),i=a("NsO/"),o=a("NV0k").f;t.exports=function(t){return function(e){for(var a,l=i(e),c=n(l),s=c.length,u=0,d=[];s>u;)a=c[u++],r&&!o.call(l,a)||d.push(t?[a,l[a]]:l[a]);return d}}},JCNI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getArticleList=function(t){return(0,i.default)({url:"/article/list",method:"post",data:t})},e.getArticleDetail=function(t,e){return(0,i.default)({url:"/article/content",method:"post",data:{article_id:t,username:e}})},e.deleteArticle=function(t){var e={article_id:t};return(0,i.default)({url:"/article/delete",method:"post",data:e})},e.articleBan=function(t,e){return(0,i.default)({url:"/article/ban",method:"post",data:{article_id:t,article_ban:e}})},e.ExcellentPost=function(t){return(0,i.default)({url:"/article/select_good_article",method:"post",data:t})},e.getGoodArticle=function(t){return(0,i.default)({url:"/article/getGoodArticles",method:"post",data:t})};var r,n=a("t3Un"),i=(r=n)&&r.__esModule?r:{default:r}},O7xx:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"complaint-mailbox"},[a("el-card",{staticClass:"mailbox-card"},[t.complaintData&&t.complaintData.length>0?a("div",{staticClass:"complaint-groups"},t._l(t.complaintData,function(e,r){return a("div",{key:r,staticClass:"complaint-group"},[a("div",{staticClass:"article-title",on:{click:function(a){return t.viewArticleDetails(e)}}},[a("span",{staticClass:"title-ellipsis"},[t._v(t._s(e.title))])]),t._v(" "),a("div",{staticClass:"report_content-list"},t._l(e.report_content,function(e,r){return a("div",{key:r,staticClass:"complaint-info"},[a("div",{staticClass:"complaint-detail"},[a("span",{staticClass:"complaint-time"},[t._v("\n                举报时间: "+t._s(e.report_time)+"\n              ")]),t._v(" "),a("span",{staticClass:"complaint-reason"},[t._v("\n                举报理由: "+t._s(e.report_msg)+"\n              ")])])])}),0),t._v(" "),a("div",{staticClass:"complaint-actions"},[a("el-button",{attrs:{type:"success",title:"帖子详情",visible:t.dialogVisible},on:{click:function(a){return t.showDialog(e)},"update:visible":function(e){t.dialogVisible=e}},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[t._v("文章详情")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.handleReview(e)}}},[t._v("审核通过")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return t.articleBan(e)}}},[t._v("文章封禁")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,title:"文章详情","modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.articleDetail?a("div",[a("p",[t._v(t._s(t.articleDetail))])]):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)])],1)}),0):a("div",[a("p",[t._v("没有举报信息。")])]),t._v(" "),a("div",{staticClass:"mailbox-footer"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"prev, pager, next",total:t.totalItems},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)])],1)},n=[];a.d(e,"a",function(){return r}),a.d(e,"b",function(){return n})},RIvy:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(a("/f1G")),n=s(a("m1cH")),i=s(a("14Xm")),o=s(a("D3Ub")),l=a("JCNI"),c=a("vWux");function s(t){return t&&t.__esModule?t:{default:t}}e.default={name:"mailbox",data:function(){return{currentPage:1,pageSize:10,totalItems:0,complaintData:[],dialogVisible:!1,articleDetail:null,username:""}},created:function(){this.fetchComplaintData()},methods:{fetchComplaintData:function(){var t=this;return(0,o.default)(i.default.mark(function e(){var a,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={page:t.currentPage,limit:t.pageSize},console.log("Params object being sent:",a),e.next=5,(0,c.getReportList)(a);case 5:if(r=e.sent,console.log(r),200!==r.code||!r.data){e.next=13;break}t.complaintData=t.groupReportContentByArticle(r.data.article_ban),t.username=r.data.username,t.totalItems=r.data.unread_count,e.next=14;break;case 13:throw new Error("Failed to fetch report list");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error fetching report content:",e.t0),t.$message.error("获取举报信息失败");case 20:case"end":return e.stop()}},e,t,[[0,16]])}))()},groupReportContentByArticle:function(t){var e=t.reduce(function(t,e){var a;return t[e.article_id]||(t[e.article_id]={article_id:e.article_id,title:e.article_content,report_content:[]}),(a=t[e.article_id].report_content).push.apply(a,(0,n.default)(e.report_content.map(function(t){return{id:t.id,report_time:t.report_time,report_msg:t.report_msg}}))),t},{});return(0,r.default)(e)},handleCurrentChange:function(t){this.currentPage=t,this.fetchComplaintData()},handleReview:function(t){var e=this;return(0,o.default)(i.default.mark(function a(){var r;return i.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("审核通过:",t),a.prev=1,r=t.article_id,a.next=5,(0,c.confirmReportMessage)(r);case 5:e.$message.success("举报信息审核成功"),e.fetchComplaintData(),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(1),console.error("Failed to confirm report:",a.t0),e.$message.error("举报信息审核失败");case 13:case"end":return a.stop()}},a,e,[[1,9]])}))()},articleBan:function(t){var e=this;return(0,o.default)(i.default.mark(function a(){var r,n;return i.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("封禁文章:",t),a.prev=1,r=t.article_id,console.log("article_id to ban:",r),n=!0,a.next=7,(0,l.articleBan)(r,n);case 7:e.$message.success("封禁帖子成功"),console.log("文章封禁成功"),e.fetchComplaintData(),console.log("Updated complaint data:",e.complaintData),a.next=17;break;case 13:a.prev=13,a.t0=a.catch(1),console.error("封禁帖子失败",a.t0),e.$message.error("封禁帖子失败");case 17:case"end":return a.stop()}},a,e,[[1,13]])}))()},showDialog:function(t){var e=this;this.articleDetail=null;var a={article_id:t.article_id,username:this.username};console.log("Sending data for getArticleDetail:",a),(0,l.getArticleDetail)(t.article_id,this.username).then(function(t){console.log(a),200===t.code?(e.articleDetail=t.data.article_content.article_text,e.dialogVisible=!0,console.log("Article detail retrieved:",e.articleDetail)):e.$message.error("获取文章详情失败")}).catch(function(t){console.error("请求文章详情失败:",t),e.$message.error("请求文章详情失败")})}}}},djtY:function(t,e,a){},fW1p:function(t,e,a){var r=a("Y7ZC"),n=a("E8gZ")(!1);r(r.S,"Object",{values:function(t){return n(t)}})},naQJ:function(t,e,a){"use strict";a.r(e);var r=a("RIvy"),n=a.n(r);for(var i in r)"default"!==i&&function(t){a.d(e,t,function(){return r[t]})}(i);e.default=n.a},nhzr:function(t,e,a){a("fW1p"),t.exports=a("WEpk").Object.values},oSA6:function(t,e,a){"use strict";a.r(e);var r=a("O7xx"),n=a("naQJ");for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);a("CEpE");var o=a("KHd+"),l=Object(o.a)(n.default,r.a,r.b,!1,null,"08847123",null);l.options.__file="index.vue",e.default=l.exports},vWux:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getReportList=function(t){return(0,i.default)({url:"/report_box/getlist",method:"post",data:t})},e.confirmReportMessage=function(t){var e={article_id:t};return(0,i.default)({url:"/report_box/ack",method:"post",data:e})};var r,n=a("t3Un"),i=(r=n)&&r.__esModule?r:{default:r}}}]);